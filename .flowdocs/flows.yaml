meta:
  app: "Orquestra"
  version: "0.2.0"
  description: "Plataforma enterprise modular con marketplace de extensiones, gestión organizacional, usuarios/roles y módulos dinámicos (KPI, Encuestas, Formularios, BI)."
  updated_at: "2026-02-22"
  sprint:
    number: 1
    goal: "Fundamentos: stack, design system y layout base"
    start: "2026-02-22"
    end: "2026-03-07"
    days_left: 13
  stats:
    total: 54
    implemented: 3
    partial: 0
    pending: 51
    with_tests: 0
    coverage_pct: 0

modules:
  - id: "landing"
    name: "Landing Page"
    description: "Página de aterrizaje pública del producto. Incluye hero con CTA, sección de beneficios, pasos de funcionamiento, extensiones destacadas, beneficios cloud y CTA final. Debe verse enterprise y profesional."
    actors: ["visitante"]

  - id: "app_shell"
    name: "App Shell (Layout)"
    description: "Estructura general de la aplicación autenticada: AppLayout con sidebar dinámica, header superior con selector de rol, área de contenido principal. Controla la inyección de módulos y menú por roles/extensiones."
    actors: ["admin", "manager", "viewer"]

  - id: "marketplace"
    name: "Marketplace de Extensiones"
    description: "Catálogo de extensiones disponibles y activas. Permite habilitar/deshabilitar módulos (KPI, Encuestas, BI). Cada extensión muestra badge de estado, descripción y botón de activación. Al activar, el sidebar se actualiza dinámicamente."
    actors: ["admin"]

  - id: "kpi"
    name: "Indicadores KPI"
    description: "Módulo de extensión para gestión y monitoreo de indicadores clave de rendimiento. Incluye listado de KPIs, creación via modal, widget para dashboard y lógica de semáforo (critical/warning/stable)."
    actors: ["admin", "manager", "viewer"]

  - id: "surveys"
    name: "Encuestas"
    description: "Módulo de extensión para crear y distribuir encuestas de satisfacción. Incluye listado de encuestas y visualización de resultados con gráficas mock."
    actors: ["admin", "manager"]

  - id: "bi"
    name: "Tableros BI"
    description: "Módulo de extensión de Business Intelligence. Dashboard con gráficas avanzadas (barras, líneas, donut) usando datos mock. Soporta descarga y compartición de reportes."
    actors: ["admin", "manager", "viewer"]

  - id: "user_management"
    name: "Gestión de Usuarios"
    description: "Administración de usuarios de la organización. Listado con búsqueda, detalle de usuario, asignación de múltiples roles via chips, asignación a grupos. Solo accesible para administradores."
    actors: ["admin"]

  - id: "roles_permissions"
    name: "Roles y Permisos"
    description: "Gestión de roles con matriz de permisos granulares (view_kpi, edit_kpi, activate_extensions, manage_users). Interfaz enterprise con tabla de permisos por rol."
    actors: ["admin"]

  - id: "user_groups"
    name: "Grupos de Usuarios"
    description: "Gestión de grupos organizacionales. Crear grupos, asignar usuarios a grupos y asignar rol por grupo. Permite organizar usuarios por departamento o función."
    actors: ["admin"]

  - id: "dashboard"
    name: "Dashboard Principal"
    description: "Panel principal de la aplicación autenticada. Muestra resumen de KPIs activos (widgets), accesos rápidos a módulos habilitados, y estado general de la organización."
    actors: ["admin", "manager", "viewer"]

  - id: "global_state"
    name: "Estado Global"
    description: "Infraestructura de estado con Zustand. Maneja rol actual, extensiones activas, usuario actual y organización. Permite activar extensión, refrescar sidebar y cambiar rol en tiempo real."
    actors: ["system"]

  - id: "organization_mgmt"
    name: "Gestión de Organización"
    description: "Módulo para gestionar la estructura jerárquica de la empresa: áreas, departamentos, responsables y empleados. Vista de árbol expandible con CRUD de áreas."
    actors: ["admin", "manager"]

  - id: "contact"
    name: "Página de Contacto"
    description: "Formulario público de captación de leads y solicitud de demo. Layout a 2 columnas con formulario + info de contacto, horarios y CTA de demo personalizada."
    actors: ["visitante"]

  - id: "forms"
    name: "Formularios"
    description: "Módulo de extensión para crear formularios personalizados y recopilar información del equipo. Incluye constructor de formularios y visualización de respuestas."
    actors: ["admin", "manager"]

entities:
  - id: "user"
    name: "Usuario"
    states: ["active", "inactive", "suspended"]
    transitions:
      - from: "active"
        to: "inactive"
        action: "Desactivar usuario"
      - from: "inactive"
        to: "active"
        action: "Reactivar usuario"
      - from: "active"
        to: "suspended"
        action: "Suspender usuario"

  - id: "role"
    name: "Rol"
    states: ["active", "disabled"]
    transitions: []

  - id: "permission"
    name: "Permiso"
    states: []
    transitions: []

  - id: "group"
    name: "Grupo"
    states: ["active", "archived"]
    transitions: []

  - id: "extension"
    name: "Extensión"
    states: ["available", "active"]
    transitions:
      - from: "available"
        to: "active"
        action: "Habilitar extensión"
      - from: "active"
        to: "available"
        action: "Deshabilitar extensión"

  - id: "kpi_indicator"
    name: "Indicador KPI"
    states: ["critical", "warning", "stable"]
    transitions:
      - from: "stable"
        to: "warning"
        action: "Valor se acerca al umbral"
      - from: "warning"
        to: "critical"
        action: "Valor supera umbral crítico"

  - id: "survey"
    name: "Encuesta"
    states: ["draft", "published", "closed"]
    transitions:
      - from: "draft"
        to: "published"
        action: "Publicar encuesta"
      - from: "published"
        to: "closed"
        action: "Cerrar encuesta"

  - id: "organization"
    name: "Organización"
    states: ["active"]
    transitions: []

  - id: "bi_report"
    name: "Reporte BI"
    states: ["generated", "shared"]
    transitions:
      - from: "generated"
        to: "shared"
        action: "Compartir reporte"

  - id: "area"
    name: "Área Organizacional"
    states: ["active", "archived"]
    transitions:
      - from: "active"
        to: "archived"
        action: "Archivar área"
      - from: "archived"
        to: "active"
        action: "Reactivar área"

  - id: "contact_lead"
    name: "Lead de Contacto"
    states: ["received", "contacted", "converted"]
    transitions:
      - from: "received"
        to: "contacted"
        action: "Contactar lead"
      - from: "contacted"
        to: "converted"
        action: "Convertir a cliente"

stories:
  # ═══════════════════════════════════════════
  # FASE 0 — PREPARACIÓN (secuencial, antes de cualquier vista)
  # ═══════════════════════════════════════════

  # ═══════════════════════════════════════════
  # US-P01: Definición de Stack Tecnológico
  # ═══════════════════════════════════════════
  - id: "US-P01"
    title: "Como equipo de desarrollo quiero definir el stack tecnológico y la estructura del proyecto para tener una base sólida antes de implementar vistas."
    module: "global_state"
    priority: "critical"
    status: "implemented"
    sprint: 1
    flow_ids: ["FLOW-P01", "FLOW-P02"]
    acceptance_criteria:
      - id: "AC-001"
        description: "El proyecto usa Next.js 15 con App Router + TypeScript strict. La raíz del proyecto es orq/ (no se crea subcarpeta)."
        validated: true
        flow_ids: ["FLOW-P01"]
      - id: "AC-002"
        description: "Se ha configurado Tailwind CSS como sistema de estilos, con tokens custom (colores, border-radius, tipografía) en tailwind.config."
        validated: true
        flow_ids: ["FLOW-P01"]
      - id: "AC-003"
        description: "Se ha instalado y configurado JSON Server como backend mock (db.json con datos iniciales, script en package.json)."
        validated: true
        flow_ids: ["FLOW-P01"]
      - id: "AC-004"
        description: "Se han instalado React Hook Form + Zod + @hookform/resolvers para validación de formularios."
        validated: true
        flow_ids: ["FLOW-P01"]
      - id: "AC-005"
        description: "El proyecto arranca en modo dev sin errores con npm run dev. JSON Server corre en paralelo (puerto 3001)."
        validated: true
        flow_ids: ["FLOW-P02"]
      - id: "AC-006"
        description: "Se ha definido la estructura de carpetas Next.js: app/ (rutas), components/, lib/, types/, mock/ (db.json)."
        validated: true
        flow_ids: ["FLOW-P01"]
      - id: "AC-007"
        description: "Se ha documentado la decisión de stack en un archivo STACK.md con justificación de cada elección."
        validated: true
        flow_ids: ["FLOW-P01"]
      - id: "AC-008"
        description: "Se ha configurado el App Router con rutas base: / (landing), /dashboard, /organizacion, /usuarios, /extensiones, /contacto."
        validated: true
        flow_ids: ["FLOW-P02"]
      - id: "AC-009"
        description: "Se ha configurado ESLint + path aliases (@/) en tsconfig.json."
        validated: true
        flow_ids: ["FLOW-P01"]

  # ═══════════════════════════════════════════
  # US-P02: Design System y Look & Feel
  # ═══════════════════════════════════════════
  - id: "US-P02"
    title: "Como equipo de desarrollo quiero implementar el design system basado en el mockup de Figma para garantizar consistencia visual en toda la plataforma."
    module: "app_shell"
    priority: "critical"
    status: "implemented"
    sprint: 1
    flow_ids: ["FLOW-P03", "FLOW-P04"]
    acceptance_criteria:
      - id: "AC-001"
        description: "Se han definido 14 tokens de color en globals.css vía @theme inline de Tailwind v4: --color-primary (#2563EB), --color-primary-light (#EEF2FF), --color-primary-hover (#1D4ED8), --color-accent-green (#16A34A), --color-accent-green-light (#F0FDF4), --color-accent-red (#DC2626), --color-accent-red-light (#FEF2F2), --color-accent-amber (#D97706), --color-accent-amber-light (#FFFBEB), --color-surface (#FFFFFF), --color-bg (#F0F4FF), --color-border (#E2E8F0), --color-cta-dark (#0F172A), --color-text-primary (#0F172A), --color-text-secondary (#64748B), --color-text-muted (#94A3B8)."
        validated: true
        flow_ids: ["FLOW-P03"]
      - id: "AC-002"
        description: "Se ha configurado la tipografía con --font-sans: 'Inter' importada desde Google Fonts en layout.tsx, con escalas de tamaño de referencia: 32px hero H1, 24px page H1, 14px body, 13px card labels, 12px badges."
        validated: true
        flow_ids: ["FLOW-P03"]
      - id: "AC-003"
        description: "Se han definido 4 tokens de border-radius en globals.css: --radius-card (12px), --radius-pill (999px), --radius-button (8px), --radius-input (8px)."
        validated: true
        flow_ids: ["FLOW-P03"]
      - id: "AC-004"
        description: "Se han definido 2 tokens de sombra en globals.css: --shadow-card (0 1px 3px rgba(0,0,0,0.06), 0 1px 2px rgba(0,0,0,0.04)) y --shadow-card-hover (0 4px 12px rgba(0,0,0,0.08), 0 2px 4px rgba(0,0,0,0.04))."
        validated: true
        flow_ids: ["FLOW-P03"]
      - id: "AC-005"
        description: "Se ha definido la iconografía con lucide-react, estilo outlined, color --color-primary, tamaño 20px para sidebar y 24px para cards."
        validated: true
        flow_ids: ["FLOW-P03"]
      - id: "AC-006"
        description: "Componente Button (components/ui/Button.tsx) con 4 variantes (primary, outline, dark, ghost), 3 tamaños (sm, md, lg), estado disabled con opacity 50%, forwardRef y clsx para composición de clases."
        validated: true
        flow_ids: ["FLOW-P04"]
      - id: "AC-007"
        description: "Componente Badge (components/ui/Badge.tsx) con 5 variantes (info, success, warning, error, neutral), forma pill (rounded-pill), padding horizontal 10px (px-2.5), tipografía 12px font-medium."
        validated: true
        flow_ids: ["FLOW-P04"]
      - id: "AC-008"
        description: "Componente Card (components/ui/Card.tsx) base con border-radius 12px (rounded-card), shadow --shadow-card, prop hover para shadow elevada (--shadow-card-hover), borde 1px --color-border y padding 24px (p-6)."
        validated: true
        flow_ids: ["FLOW-P04"]
      - id: "AC-009"
        description: "Componente Input (components/ui/Input.tsx) con slot de icono izquierdo opcional, border-radius 8px (rounded-input), focus ring azul (ring-primary), padding adaptativo cuando hay icono (pl-10)."
        validated: true
        flow_ids: ["FLOW-P04"]
      - id: "AC-010"
        description: "Componente KpiCard (components/ui/KpiCard.tsx) que compone Card + Badge + iconos Lucide (TrendingUp/TrendingDown/Minus), con props: title (string), value (string|number), change (string), trend (up/down/neutral), icon (ReactNode)."
        validated: true
        flow_ids: ["FLOW-P04"]
      - id: "AC-011"
        description: "Componente ExtensionCard (components/ui/ExtensionCard.tsx) con resolución dinámica de iconos Lucide por nombre, statusConfig (available/active/coming-soon → badge + botón), props: name, description, iconName, status, category, onToggle."
        validated: true
        flow_ids: ["FLOW-P04"]
      - id: "AC-012"
        description: "Componentes TableRow (components/ui/TableRow.tsx) y TreeItem (components/ui/TreeItem.tsx) para tablas de usuarios y árbol organizacional. Existe página de showcase (app/(app)/showcase/page.tsx) renderizando todos los componentes con sus variantes."
        validated: true
        flow_ids: ["FLOW-P04"]


  # ═══════════════════════════════════════════
  # US-P03: Datos Mock Realistas
  # ═══════════════════════════════════════════
  - id: "US-P03"
    title: "Como equipo quiero datos mock realistas y coherentes para que todas las vistas se puedan implementar con datos representativos desde el inicio."
    module: "global_state"
    priority: "high"
    status: "pending"
    sprint: 1
    flow_ids: ["FLOW-P05", "FLOW-P06"]
    acceptance_criteria:
      - id: "AC-001"
        description: "Existen al menos 10 usuarios mock con nombres españoles, emails @orquestra.com y teléfonos +34 600 XXX XXX."
        validated: false
        flow_ids: ["FLOW-P05"]
      - id: "AC-002"
        description: "Existen al menos 14 áreas organizacionales mock con jerarquía (Dirección General como raíz), empleados y responsables."
        validated: false
        flow_ids: ["FLOW-P05"]
      - id: "AC-003"
        description: "Existen 5 extensiones mock: 3 disponibles (KPI, Formularios, Encuestas) y 2 próximamente (Colaboración, BI)."
        validated: false
        flow_ids: ["FLOW-P05"]
      - id: "AC-004"
        description: "Existen 3 roles mock: Directivo (todos los permisos), Responsable de área (parcial), Colaborador (solo lectura)."
        validated: false
        flow_ids: ["FLOW-P06"]
      - id: "AC-005"
        description: "Los KPIs mock incluyen: Resumen organización (12 áreas, 148 colaboradores), Actividad reciente (24 hoy, +18%), Estado del sistema (100% operativo)."
        validated: false
        flow_ids: ["FLOW-P05"]
      - id: "AC-006"
        description: "Cada entidad mock tiene IDs únicos y relaciones coherentes (usuarios asignados a áreas, áreas con responsables)."
        validated: false
        flow_ids: ["FLOW-P05"]
      - id: "AC-007"
        description: "Los datos se exportan desde un archivo centralizado (mock/data.ts) con tipos TypeScript."
        validated: false
        flow_ids: ["FLOW-P06"]
      - id: "AC-008"
        description: "El store React Context se inicializa con estos datos mock al montar la app."
        validated: false
        flow_ids: ["FLOW-P06"]

  # ═══════════════════════════════════════════
  # FASE 1 — VISTAS PRINCIPALES (secuencial)
  # ═══════════════════════════════════════════

  # ═══════════════════════════════════════════
  # US-001: Landing Page Enterprise
  # ═══════════════════════════════════════════
  
  - id: "US-001"
    title: "Landing enterprise orientada a decisión ejecutiva"
    module: "landing"
    priority: "high"
    status: "implemented"
    sprint: 1
    story_points: 8
    actors: ["visitante", "director", "tomador_decision"]

    narrative: >
      Como director o responsable de transformación digital,
      quiero ingresar a la landing de Orquestra y comprender en segundos
      que se trata de una plataforma empresarial modular, confiable y escalable,
      para evaluar rápidamente su adopción y acceder a una demostración.

    business_context:
      product_positioning: "Plataforma enterprise modular tipo ecosystem-driven (similar a Salesforce AppExchange mindset)"
      key_message: "Activa solo las capacidades que tu organización necesita"
      differentiation:
        - "Arquitectura por extensiones activables"
        - "Marketplace integrado"
        - "Enfoque enterprise-first"
        - "Time-to-value acelerado"

    ux_intent:
      primary_goal: "Conversión a demo"
      secondary_goal: "Confianza ejecutiva"
      tertiary_goal: "Comprensión del modelo modular"
      emotional_tone:
        - "corporativo"
        - "confiable"
        - "moderno"
        - "tecnológicamente sólido"

    information_architecture:
      required_sections:
        - "Hero estratégico"
        - "Propuesta de valor empresarial"
        - "Modelo de plataforma modular"
        - "Capacidades clave"
        - "Extensiones destacadas"
        - "Beneficios enterprise/cloud"
        - "CTA de conversión"
        - "Footer institucional"

    acceptance_criteria:

      - id: "AC-001"
        name: "Hero con posicionamiento ejecutivo"
        description: >
          La sección hero comunica inmediatamente que Orquestra es
          una plataforma empresarial modular. Debe incluir:
          - H1 orientado a transformación operativa medible
          - Subtítulo que mencione explícitamente el modelo por extensiones
          - Mockup limpio tipo dashboard enterprise
          - CTA primario hacia demo
          - CTA secundario informativo
        validations:
          - "El valor modular se entiende en ≤5 segundos"
          - "Existe exactamente un H1"
          - "El hero es above-the-fold en desktop"
          - "El diseño transmite estética enterprise (no startup genérica)"
        validated: true
        flow_ids: ["FLOW-001"]

      - id: "AC-002"
        name: "Sección de propuesta de valor"
        description: >
          Existe una sección que explica claramente que Orquestra permite
          construir soluciones empresariales mediante la activación de
          extensiones bajo demanda.
        validations:
          - "Se menciona explícitamente el concepto de extensiones"
          - "Se comunica el beneficio de usar solo lo necesario"
          - "El lenguaje es corporativo, no técnico excesivo"
          - "La jerarquía visual guía la lectura ejecutiva"
        validated: true
        flow_ids: ["FLOW-002"]

      - id: "AC-003"
        name: "Modelo de plataforma modular"
        description: >
          Existe una sección visual que explique el flujo:
          Organización → Activación de extensiones → Solución operativa.
        validations:
          - "El flujo se entiende sin leer texto largo"
          - "Existe apoyo visual (diagrama, steps o visual flow)"
          - "Refuerza el concepto de escalabilidad"
        validated: true
        flow_ids: ["FLOW-002"]

      - id: "AC-004"
        name: "Capacidades empresariales"
        description: >
          Existe una sección de capacidades clave con cards
          (ej. multi-organización, KPI, automatización, gobierno de datos).
        validations:
          - "Las capacidades están orientadas a empresa, no a usuario individual"
          - "Iconografía consistente"
          - "Grid responsive"
          - "Hover states en desktop"
        validated: true
        flow_ids: ["FLOW-002"]

      - id: "AC-005"
        name: "Extensiones destacadas como marketplace"
        description: >
          La landing muestra extensiones (KPI, Encuestas, BI) claramente
          etiquetadas como 'Extensión' o 'Módulo activable', reforzando
          el modelo tipo marketplace.
        validations:
          - "Cada item tiene badge de extensión"
          - "Se entiende que pueden activarse bajo demanda"
          - "La sección transmite mentalidad de ecosystem"
        validated: true
        flow_ids: ["FLOW-002"]

      - id: "AC-006"
        name: "Beneficios enterprise y cloud"
        description: >
          Existe una sección que comunique atributos enterprise:
          seguridad, escalabilidad, multi-tenant, alta disponibilidad.
        validations:
          - "Lenguaje orientado a TI/directores"
          - "Diseño visual diferenciado (sección premium)"
          - "No usa claims vacíos sin contexto"
        validated: true
        flow_ids: ["FLOW-002"]

      - id: "AC-007"
        name: "Navegación corporativa"
        description: >
          La navbar sticky muestra logo Orquestra y navegación clara
          orientada a exploración ejecutiva.
        validations:
          - "Sticky funcional"
          - "Responsive con menú móvil"
          - "Estados hover y focus"
          - "Accesible por teclado"
        validated: true
        flow_ids: ["FLOW-003"]

      - id: "AC-008"
        name: "Experiencia responsive premium"
        description: >
          La landing mantiene calidad visual y legibilidad
          en móvil, tablet y desktop.
        validations:
          - "Sin scroll horizontal en 320px"
          - "CTAs táctiles ≥44px"
          - "Tipografía escala correctamente"
          - "Las secciones mantienen jerarquía visual"
        validated: true
        flow_ids: ["FLOW-001"]

      - id: "AC-009"
        name: "CTA final orientado a decisión"
        description: >
          La página cierra con un bloque de conversión que invite
          a solicitar demo o información, reforzando confianza enterprise.
        validations:
          - "Ubicado antes del footer"
          - "Mensaje orientado a valor de negocio"
          - "Botón primario consistente con design system"
        validated: true
        flow_ids: ["FLOW-002"]

    non_functional_requirements:
      performance:
        - "Lighthouse ≥ 90"
        - "LCP < 2.5s"
        - "CLS < 0.1"
      accessibility:
        - "WCAG 2.1 AA básico"
        - "Navegación por teclado"
      seo:
        - "Metadata completa"
        - "OpenGraph"
        - "Estructura semántica correcta"

    definition_of_done:
      - "La propuesta modular se entiende claramente"
      - "La página transmite confianza enterprise"
      - "Todos los AC validados"
      - "Build de producción exitoso"
      - "Revisión UX aprobada"
  
  # ═══════════════════════════════════════════
  # US-002: Página de contacto corporativa con confirmación de envío
  # ═══════════════════════════════════════════
  - id: "US-002"
    title: "Página de contacto corporativa con confirmación de envío"
    module: "landing"
    priority: "high"
    status: "pending"
    sprint: 1
    story_points: 8
    actors: ["visitante", "cto", "director", "tomador_decision"]

    narrative: >
      Como Director de Tecnología o responsable de evaluar plataformas,
      quiero acceder a una página de contacto clara, moderna y confiable
      para solicitar información sobre precios, planes y capacidades de Orquestra,
      y recibir confirmación inmediata de que mi mensaje fue enviado correctamente.

    business_goal:
      - "Capturar leads calificados enterprise"
      - "Reducir fricción en el primer contacto"
      - "Transmitir confianza corporativa"
      - "Preparar pipeline comercial"

    ux_intent:
      primary_goal: "Envío exitoso del formulario"
      secondary_goal: "Generar confianza post-envío"
      emotional_tone:
        - "profesional"
        - "moderno"
        - "enterprise"
        - "confiable"
        - "sin fricción"

    functional_scope:

      form_fields_required:
        - "Nombre completo"
        - "Correo corporativo"
        - "Organización"
        - "Rol"
        - "Mensaje"
      optional_fields:
        - "Teléfono"
        - "Tamaño de la organización"
        - "Interés principal (planes, demo, partnership, etc.)"

      system_behaviors:
        - "Validación en tiempo real"
        - "Estado de carga al enviar"
        - "Mensaje de éxito visible"
        - "Envío de correo al equipo comercial"
        - "Correo de confirmación al usuario"
        - "Prevención de spam básica"

    acceptance_criteria:

      - id: "AC-001"
        name: "Diseño corporativo de la página"
        description: >
          La página de contacto presenta un layout moderno,
          limpio y alineado al design system enterprise de Orquestra.
        validations:
          - "Jerarquía visual clara"
          - "Espaciado consistente"
          - "Tipografía enterprise"
          - "Responsive completo"
        validated: false

      - id: "AC-002"
        name: "Formulario intuitivo"
        description: >
          El formulario es fácil de completar para un ejecutivo,
          con labels claros, placeholders útiles y agrupación lógica.
        validations:
          - "Tiempo estimado de llenado ≤ 60 segundos"
          - "Campos obligatorios marcados"
          - "Errores visibles inline"
          - "Navegación por teclado funcional"
        validated: false

      - id: "AC-003"
        name: "Sugerencias inteligentes de mensaje"
        description: >
          La UI muestra ejemplos o chips de ayuda sobre
          qué puede solicitar el usuario (ej. precios, demo, arquitectura).
        validations:
          - "Existen al menos 4 sugerencias visibles"
          - "Al hacer click se insertan en el textarea"
          - "No interfieren con escritura manual"
        validated: false

      - id: "AC-004"
        name: "Envío funcional del formulario"
        description: >
          Al enviar, el sistema procesa la solicitud de forma asíncrona
          y muestra estado de carga.
        validations:
          - "Botón muestra loading state"
          - "Se evita doble envío"
          - "Timeout manejado correctamente"
          - "Errores de red manejados"
        validated: false

      - id: "AC-005"
        name: "Confirmación visual inmediata"
        description: >
          Tras envío exitoso, el usuario ve un mensaje claro de confirmación
          sin abandonar la página.
        validations:
          - "Mensaje de éxito visible"
          - "Tono corporativo y tranquilizador"
          - "Incluye expectativa de tiempo de respuesta"
          - "Accesible por lectores de pantalla"
        validated: false

      - id: "AC-006"
        name: "Correo recibido por el equipo"
        description: >
          El sistema envía un email estructurado al equipo comercial
          con la información del lead.
        validations:
          - "Incluye todos los campos"
          - "Formato legible"
          - "Timestamp incluido"
          - "Ambiente configurable (dev/prod)"
        validated: false

      - id: "AC-007"
        name: "Correo de confirmación al usuario"
        description: >
          El usuario recibe un correo automático confirmando
          la recepción de su solicitud.
        validations:
          - "Enviado al correo capturado"
          - "Incluye resumen del mensaje"
          - "Branding de Orquestra"
          - "Tiempo estimado de respuesta"
        validated: false

      - id: "AC-008"
        name: "Experiencia responsive premium"
        description: >
          La página mantiene usabilidad y estética en móvil,
          tablet y desktop.
        validations:
          - "Sin scroll horizontal en 320px"
          - "Campos táctiles ≥44px"
          - "CTA visible en viewport móvil"
        validated: false

      - id: "AC-009"
        name: "Protección básica anti-spam"
        description: >
          El formulario implementa al menos una medida anti-spam.
        validations:
          - "Honeypot o equivalente"
          - "Rate limiting básico"
          - "Validación de dominio de correo"
        validated: false

    non_functional_requirements:
      performance:
        - "Tiempo de envío percibido < 2s"
        - "Sin bloqueo del main thread"
      accessibility:
        - "WCAG 2.1 AA"
        - "ARIA live en mensaje de éxito"
      security:
        - "Sanitización de inputs"
        - "Protección contra XSS"
        - "Validación server-side obligatoria"

    analytics_events:
      - "contact_form_view"
      - "contact_form_submit"
      - "contact_form_success"
      - "contact_form_error"

    definition_of_done:
      - "Formulario envía correctamente"
      - "Usuario recibe correo de confirmación"
      - "Equipo recibe lead"
      - "UX aprobada por diseño"
      - "Tests básicos pasando"
      - "Sin errores en consola"


# ═══════════════════════════════════════════
# US-003: Solicitud de demo guiada con captura de lead calificado
# ═══════════════════════════════════════════
  - id: "US-003"
    title: "Solicitud de demo guiada con captura de lead calificado"
    module: "landing"
    priority: "high"
    status: "pending"
    sprint: 1
    story_points: 8
    actors: ["visitante", "cto", "director", "tomador_decision"]

    narrative: >
      Como Director de Tecnología o responsable de evaluar plataformas,
      quiero solicitar una demo de Orquestra desde la landing,
      proporcionando mis datos de forma rápida y profesional,
      para que el equipo comercial me contacte y me muestre el producto.

    strategic_note: >
      Esta funcionalidad reutiliza la infraestructura del formulario de contacto,
      pero optimizada para intención de compra (high-intent lead).

    business_goal:
      - "Capturar leads de alta intención"
      - "Acelerar pipeline comercial"
      - "Reducir fricción para solicitud de demo"
      - "Segmentar prospectos enterprise"

    ux_intent:
      primary_goal: "Solicitud de demo completada"
      secondary_goal: "Percepción de proceso enterprise"
      emotional_tone:
        - "premium"
        - "ágil"
        - "confiable"
        - "orientado a negocio"

    reuse_strategy:
      base_component: "ContactForm"
      reuse_level: "alto"
      differences:
        - "copy orientado a demo"
        - "tracking específico"
        - "campos de calificación opcionales"
        - "ruta dedicada /demo"

    functional_scope:
      entry_points:
        - "Hero CTA 'Solicitar demo'"
        - "CTA final de la landing"
        - "Navbar (opcional futuro)"

      form_fields_required:
        - "Nombre completo"
        - "Correo corporativo"
        - "Organización"
        - "Rol"
      recommended_fields:
        - "Tamaño de la organización"
        - "Interés principal"
        - "¿Qué deseas ver en la demo?"

      system_behaviors:
        - "Apertura en página dedicada o modal"
        - "Validación en tiempo real"
        - "Loading state"
        - "Confirmación visual"
        - "Email al equipo comercial"
        - "Email de confirmación al solicitante"

    acceptance_criteria:
      - id: "AC-001"
        name: "Navegación desde CTA"
        description: >
          Al hacer click en 'Solicitar demo', el usuario es dirigido
          a la experiencia de solicitud de demo sin fricción.
        validations:
          - "Navegación client-side"
          - "Tiempo de transición < 300ms"
          - "Evento analytics disparado"
        validated: false

      - id: "AC-002"
        name: "Experiencia diferenciada de demo"
        description: >
          La página o modal comunica claramente que se trata
          de una solicitud de demo guiada.
        validations:
          - "Headline orientado a demo"
          - "Microcopy de expectativa de contacto"
          - "Diseño consistente con branding"
        validated: false

      - id: "AC-003"
        name: "Formulario optimizado para lead calificado"
        description: >
          El formulario reutiliza el componente base pero
          prioriza rapidez y calidad del lead.
        validations:
          - "Tiempo de llenado ≤ 60s"
          - "Campos obligatorios mínimos"
          - "Validación inline"
          - "Accesible por teclado"
        validated: false

      - id: "AC-004"
        name: "Envío y estado de carga"
        description: >
          Al enviar la solicitud, el sistema procesa
          de forma asíncrona mostrando feedback visual.
        validations:
          - "Botón muestra loading"
          - "Prevención de doble submit"
          - "Errores manejados"
        validated: false

      - id: "AC-005"
        name: "Confirmación post-solicitud"
        description: >
          Tras envío exitoso, el usuario ve confirmación clara
          con expectativa de contacto.
        validations:
          - "Mensaje visible"
          - "Tono corporativo"
          - "Incluye tiempo estimado de respuesta"
          - "ARIA live presente"
        validated: false

      - id: "AC-006"
        name: "Notificación al equipo comercial"
        description: >
          El sistema envía email estructurado marcando
          el lead como 'Demo Request'.
        validations:
          - "Incluye metadata de origen"
          - "Timestamp"
          - "Campos completos"
        validated: false

      - id: "AC-007"
        name: "Correo de confirmación al solicitante"
        description: >
          El usuario recibe confirmación automática
          de que su demo fue solicitada.
        validations:
          - "Branding Orquestra"
          - "Resumen de solicitud"
          - "Próximos pasos claros"
        validated: false

      - id: "AC-008"
        name: "Experiencia responsive premium"
        description: >
          La solicitud de demo funciona correctamente
          en móvil, tablet y desktop.
        validations:
          - "Sin overflow en 320px"
          - "Inputs táctiles ≥44px"
          - "CTA visible"
        validated: false

    analytics_events:
      - "demo_cta_click"
      - "demo_form_view"
      - "demo_form_submit"
      - "demo_form_success"
      - "demo_form_error"

    non_functional_requirements:
      performance:
        - "Tiempo de envío percibido < 2s"
      accessibility:
        - "WCAG 2.1 AA"
      security:
        - "Validación server-side"
        - "Sanitización inputs"
        - "Protección anti-spam"

    definition_of_done:
      - "Solicitud de demo funcional"
      - "Correos enviados correctamente"
      - "Tracking activo"
      - "UX aprobada"
      - "Sin errores en consola"

# ========================================= 
# US-004  Diferenciación clara entre Contacto y Solicitar demo
# ========================================= 

  - id: "US-004"
    title: "Diferenciación clara entre Contacto y Solicitar demo"
    module: "landing"
    priority: "high"
    status: "pending"
    sprint: 1
    story_points: 5
    actors: ["visitante", "cto", "director", "tomador_decision"]

    narrative: >
      Como Director de Tecnología evaluando Orquestra,
      experimenté confusión entre el formulario de Contacto
      y el de Solicitar demo porque ambos se ven y funcionan igual.
      Quiero que cada experiencia esté claramente diferenciada
      en propósito, mensaje y ayudas visuales,
      para saber cuál utilizar según mi necesidad.

    problem_statement:
      current_issue: >
        Los formularios de Contacto y Solicitar demo comparten
        estructura, ayudas y apariencia casi idéntica,
        lo que genera ambigüedad en la intención del usuario.
      business_risk:
        - "Fricción en conversión"
        - "Leads mal calificados"
        - "Experiencia poco enterprise"
        - "Duda en el decision maker"
      user_impact:
        - "No sé cuál elegir"
        - "No entiendo la diferencia"
        - "Percibo falta de madurez del producto"

    business_goal:
      - "Eliminar ambigüedad entre flujos"
      - "Mejorar calidad de leads"
      - "Aumentar conversión a demo"
      - "Transmitir madurez enterprise"

    ux_intent:
      primary_goal: "Claridad de propósito por flujo"
      secondary_goal: "Reducir fricción cognitiva"
      emotional_tone:
        - "claro"
        - "guiado"
        - "enterprise"
        - "intencional"

    differentiation_strategy:

      required_differences:
        - "headline específico por flujo"
        - "subcopy contextual"
        - "sugerencias inteligentes distintas"
        - "campo adicional en demo"
        - "microcopy de expectativa diferente"
        - "tracking diferenciado"

      visual_differences:
        - "iconografía contextual"
        - "badge o label del flujo"
        - "hero/header distinto"
        - "orden de campos optimizado por intención"

    acceptance_criteria:

      - id: "AC-001"
        name: "Propósito explícito por página"
        description: >
          Cada página comunica claramente su objetivo
          antes de mostrar el formulario.
        validations:
          - "Contacto orientado a preguntas generales"
          - "Demo orientado a ver el producto"
          - "Headline distinto en cada página"
          - "Subtítulo contextual"
        validated: false

      - id: "AC-002"
        name: "Sugerencias inteligentes diferenciadas"
        description: >
          Los chips de ayuda del formulario son distintos
          entre Contacto y Demo.
        validations:
          - "Contacto muestra preguntas informativas"
          - "Demo muestra intereses de demo"
          - "No comparten exactamente los mismos textos"
        validated: false

      - id: "AC-003"
        name: "Campo adicional en solicitud de demo"
        description: >
          El formulario de demo incluye al menos un campo
          específico de calificación de demo.
        validations:
          - "Existe campo '¿Qué deseas ver en la demo?'"
          - "No aparece en contacto"
          - "Es opcional pero visible"
        validated: false

      - id: "AC-004"
        name: "Microcopy de expectativa diferenciada"
        description: >
          El mensaje previo al envío explica claramente
          qué ocurrirá después en cada flujo.
        validations:
          - "Contacto promete respuesta informativa"
          - "Demo promete agendamiento o contacto comercial"
          - "Lenguaje corporativo"
        validated: false

      - id: "AC-005"
        name: "Confirmaciones post-envío distintas"
        description: >
          El mensaje de éxito refleja el tipo de solicitud.
        validations:
          - "Contacto: confirmación de recepción"
          - "Demo: próximos pasos de demo"
          - "Incluyen tiempos estimados"
        validated: false

      - id: "AC-006"
        name: "Tracking diferenciado"
        description: >
          Analytics distingue claramente ambos flujos.
        validations:
          - "contact_form_submit"
          - "demo_form_submit"
          - "No se mezclan eventos"
        validated: false

      - id: "AC-007"
        name: "Reutilización técnica sin duplicación"
        description: >
          El sistema reutiliza el componente base
          manteniendo diferenciación por variante.
        validations:
          - "Existe LeadForm reutilizable"
          - "Uso de prop variant"
          - "Sin lógica duplicada"
        validated: false

    non_functional_requirements:
      ux_quality:
        - "La diferencia se entiende en <5 segundos"
        - "No aumenta el tiempo de llenado"
      accessibility:
        - "WCAG 2.1 AA"
      performance:
        - "Sin impacto perceptible en carga"

    definition_of_done:
      - "Usuarios distinguen claramente ambos flujos"
      - "Sin duplicación de lógica"
      - "UX validada"
      - "Eventos analytics correctos"
      - "Copy aprobado por negocio"

flows:
  # ─── LANDING PAGE ────────────────────────────
  - id: "FLOW-001"
    name: "Visualizar Hero y CTA principal"
    type: "user_flow"
    module: "landing"
    actor: "visitante"
    priority: "high"
    status: "pending"
    test_status: "none"
    sprint_status: "todo"
    story: "US-001"
    story_points: 3
    entities: []
    trigger: "El visitante accede a la URL raíz (/)"
    preconditions: ["Ninguna"]
    steps:
      - "El visitante accede a la URL raíz"
      - "El sistema renderiza el hero section y botón CTA 'Ver demo'"
      - "El visitante hace clic en 'Ver demo'"
      - "El sistema navega a /demo"
    alternatives:
      - "Si el visitante hace clic en 'Hablar con Ventas', se muestra un modal de contacto (mock)"
    errors: []

  - id: "FLOW-002"
    name: "Explorar secciones informativas"
    type: "user_flow"
    module: "landing"
    actor: "visitante"
    priority: "medium"
    status: "pending"
    test_status: "none"
    sprint_status: "todo"
    story: "US-001"
    story_points: 3
    entities: []
    trigger: "El visitante hace scroll en la landing page"
    preconditions: ["El visitante está en /"]
    steps:
      - "El visitante hace scroll hacia abajo"
      - "Aparece la sección de beneficios con 6 cards (ícono, título, descripción)"
      - "Aparece la sección 'Cómo Funciona' con 3 pasos numerados"
      - "Aparece la sección de extensiones destacadas con preview de KPI, Encuestas y BI"
      - "Aparece el CTA final con fondo oscuro y botón de acción"
    alternatives: []
    errors: []

  - id: "FLOW-003"
    name: "Navegar desde la barra sticky"
    type: "user_flow"
    module: "landing"
    actor: "visitante"
    priority: "low"
    status: "pending"
    test_status: "none"
    sprint_status: "todo"
    story: "US-001"
    story_points: 1
    entities: []
    trigger: "El visitante interactúa con la navbar sticky"
    preconditions: ["El visitante está en /"]
    steps:
      - "El visitante carga la página y ve la navbar fija con logo y links"
      - "Al hacer clic en 'Características' se navega con scroll suave a la sección de features"
      - "Al hacer clic en 'Ir al Demo' se navega a /marketplace"
    alternatives: []
    errors: []
